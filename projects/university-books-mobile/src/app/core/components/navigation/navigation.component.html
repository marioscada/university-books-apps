<!-- Search and Avatar Buttons (All screen sizes) -->
@if (showNavigation()) {
  <div class="header-actions">
    <!-- Search Button (GitHub style) -->
    <button
      #searchButton
      class="search-trigger-btn"
      type="button"
      aria-label="Search"
      (click)="openSearch()"
    >
      <ion-icon name="search-outline" class="search-trigger-icon"></ion-icon>
      <span class="search-trigger-text">Type</span>
      <kbd class="search-trigger-key">/</kbd>
      <span class="search-trigger-text">to search</span>
    </button>

    <!-- Avatar Button -->
    <button
      class="avatar-header-btn"
      type="button"
      aria-label="Open user profile"
      (click)="openProfileSidebar()"
    >
      <ion-icon
        name="person-circle"
        class="avatar-icon"
      ></ion-icon>
    </button>
  </div>
}

<!-- Hamburger Menu Button (Always visible - GitHub style) -->
@if (showNavigation()) {
  <button
    class="hamburger-btn"
    type="button"
    [attr.aria-expanded]="isMobileMenuOpen()"
    [attr.aria-label]="isMobileMenuOpen() ? 'Close menu' : 'Open menu'"
    (click)="toggleMobileMenu()"
  >
    <ion-icon
      [name]="isMobileMenuOpen() ? 'close-outline' : 'menu-outline'"
      class="hamburger-icon"
    ></ion-icon>
  </button>
}

<!-- Backdrop Overlay (Always when menu is open) -->
@if (showNavigation() && isMobileMenuOpen()) {
  <div
    [@fadeIn]
    class="backdrop"
    role="button"
    tabindex="0"
    [attr.aria-label]="'Close navigation menu'"
    (click)="closeMobileMenu()"
    (keydown.enter)="closeMobileMenu()"
    (keydown.escape)="closeMobileMenu()"
  ></div>
}

<!-- Sidebar Navigation -->
@if (showSidebar()) {
  <nav
    [@slideIn]
    class="sidebar"
    [class.sidebar-mobile]="isMobile()"
    [class.sidebar-tablet]="isTablet()"
    [class.sidebar-desktop]="isDesktop()"
    [attr.aria-label]="'Main navigation'"
  >
    <!-- Navigation Header -->
    <div class="nav-header">
      <div class="nav-logo">
        <ion-icon
          name="library"
          class="logo-icon"
        ></ion-icon>
        <div class="logo-content">
          <span class="logo-title">Books</span>
          <span class="logo-subtitle">Create & Share</span>
        </div>
      </div>
    </div>

    <!-- Navigation Items -->
    <ul class="nav-list">
      @for (item of navigationItems; track item.id) {
        <li class="nav-item">
          <a
            [routerLink]="item.route"
            class="nav-link"
            [class.nav-link-active]="isActive(item)"
            [attr.aria-current]="isActive(item) ? 'page' : null"
            (click)="navigateTo(item)"
          >
            <!-- Icon -->
            <ion-icon
              [name]="item.icon"
              class="nav-icon"
            ></ion-icon>

            <!-- Label -->
            <span class="nav-label">{{ item.label }}</span>

            <!-- Badge (if present) -->
            @if (item.badge && item.badge > 0) {
              <span
                class="nav-badge"
                [attr.aria-label]="item.badge + ' notifications'"
              >
                {{ item.badge }}
              </span>
            }
          </a>
        </li>
      }
    </ul>
  </nav>
}

<!-- Profile Sidebar (All screen sizes) -->
@if (isProfileSidebarOpen()) {
  <app-user-profile-sidebar
    (closeSidebar)="closeProfileSidebar()"
  ></app-user-profile-sidebar>
}
